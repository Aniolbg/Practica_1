---
title: "Practica_1"
author: "Aniol, LOmar, Marcel"
date: "2025-12-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(stringr)
data <- read.table("epa-http.csv", sep = "", col.names = c("IP", "timestamp", "method", "URL", "protocol", "code", "bytes"), fill = TRUE, quote = "", stringsAsFactors = FALSE, header = FALSE)
```

# Práctica 1

## Data Science

### Pregunta 1

**De las siguientes preguntas, clasifica cada una como descriptiva, exploratoria, inferencia, predictiva o causal, y razona brevemente (una frase) el porqué:**

1.  Dado un registro de vehículos que circulan por una autopista, disponemos de su marca y modelo, país de matriculación, y tipo de vehículo (por número de ruedas). Con tal de ajustar precios de los peajes, ¿Cuántos vehículos tenemos por tipo? ¿Cuál es el tipo más frecuente? ¿De qué países tenemos más vehículos?

Descriptiva: esto es debido a que la pregunta trata de contar y resumir datos ya existentes, solo describe cómo es el conjunto.

2.  Dado un registro de visualizaciones de un servicio de video-on-demand, donde disponemos de los datos del usuario, de la película seleccionada, fecha de visualización y categoría de la película, queremos saber ¿Hay alguna preferencia en cuanto a género literario según los usuarios y su rango de edad?

Exploratoria: ya que el objetivo de la pregunta es descubrir la relación entre variables, en este caso entre edad y género de películas.

3.  Dado un registro de peticiones a un sitio web, vemos que las peticiones que provienen de una red de telefonía concreta acostumbran a ser incorrectas y provocarnos errores de servicio. ¿Podemos determinar si en el futuro, los próximos mensajes de esa red seguirán dando problemas? ¿Hemos notado el mismo efecto en otras redes de telefonía?

Predictiva: ya que se pregunta si nos podemos anticipar al futuro comportamineto de esa red específica basándonos en los datos que ya tenemos.

4.  Dado los registros de usuarios de un servicio de compras por internet, los usuarios pueden agruparse por preferencias de productos comprados. Queremos saber si ¿Es posible que, dado un usuario al azar y según su historial, pueda ser directamente asignado a un o diversos grupos?

Inferencial: la pregunta busca generalizar, ya que dado un usuario nuevo lo asigna a un grupo según patrones observados en la muestra.

### Pregunta 2

**Considerando el escenario:** **Explica con detalle cómo se podría proceder al análisis y resolución del problema mediante Data Science, indicando de donde se obtendrían los datos, qué tratamiento deberían recibir, qué preguntas hacerse para resolver el problema, qué datos y gráficos se obtendrían, y cómo se comunicarían estos.**

-   Los datos podrían ser obtenidos de resgitros de conexiones TCP como IPs origen, destino, etc, también de inventario de PCs y de los usuarios y finalmente mirando el listado de servicios web utilizados.

-   Para el tratamiento de los datos seria necesario hacer una limpieza y normalización de IPs, puertos, timestamps, etc. También seria necesario filtrar el tráfico legítimo.

-   Para resolver el problema nos podemos hacer las siguientes preguntas:

    -   Que ordenadores muestran patrones de servidor?
    -   Que puertos tiene actividad sospechosa?
    -   Es persistene o temporal? Coincide con las excepciones registradas?

-   De los datos recabados se obrendria una mesa de sospechosos con sus ordenadores, puertos, número de orígenes externos y diás activos.

    También obtendríamos los siguientes gráficos:

    -   Histogramas de puesrtos utilizados
    -   Hetmaps de actividad por hora/dia
    -   Mapas de países/ASNs de origen

-   Para comunicarlo todo se puede hacer a través de un informe corto a la dirección que tenga una lista reducida de los posibles sospechosos. Además de enviarles un mensaje a los trabajadores implicados con pruebas claras y un tono constructivo.

## Introducción a R

### Pregunta 1

**1. Cuales son las dimensiones del dataset cargado (número de filas y columnas)**

```{r}
cat(sprintf("El dataset tiene %d columnas y %d filas", ncol(data), nrow(data)))
```

**2. Valor medio de la columna Bytes**

```{r}
data_bytes <- data$bytes
data_bytes[data_bytes == "-"] <- NA
data_bytes <- as.numeric(data_bytes)
medio <- mean(data_bytes, na.rm = TRUE)
cat(sprintf("El valor medio de la columna bytes es %.2f", medio))
```

### Pregunta 2

**De las diferentes IPs de origen accediendo al servidor, ¿cuantas pertenecen a una IP claramente educativa (que contenga ".edu")?**

```{r}
data_ip <- data$IP
IP_edu <- sum(str_detect(data_ip, "\\.edu"))
cat(sprintf("Hay %d de Ips Educativas", IP_edu))
```

### Pregunta 3

**De todas las peticiones recibidas por el servidor cual es la hora en la que hay mayor volumen de peticiones HTTP de tipo "GET"?**

Hemos asumido que la estructura del tiempo es [dia:hora:minuto:segundo]

```{r}
data_get <- data[data$method == "\"GET", ]
timestamp_get <- data_get$timestamp
hours <- sapply(strsplit(data_get$timestamp, ":"), `[`, 2)
freq_horas <- table(hours)
hora_max <- names(which.max(freq_horas))
cat(sprintf("La hora en la que hay mayores peticiones GET son las %s ", hora_max))
```

### Pregunta 4

**De las peticiones hechas por instituciones educativas (.edu), ¿Cuantos bytes en total se han transmitido, en peticiones de descarga de ficheros de texto ".txt"?**

```{r}
ata_edu <- data[str_detect(data$IP, "\\.edu"), ]
ata_edu <- ata_edu[str_detect(ata_edu$URL, "\\.txt"), ]
txt_bytes <- as.numeric(ata_edu$bytes)
txt_bytes <- sum(txt_bytes, na.rm = TRUE)
cat(sprintf("Se han transmitido %d bytes de archivos .txt de instituciones educativas", txt_bytes))
```

### Pregunta 5

**Si separamos la petición en 3 partes (Tipo, URL, Protocolo), usando str_split y el separador " " (espacio), ¿cuantas peticiones buscan directamente la URL = "/"?**

```{r}
sum_url <- sum(data$URL == "/")
cat(sprintf("Han habido %d peticiones que buscan la URL /", sum_url))
```

### Pregunta 6

**Aprovechando que hemos separado la petición en 3 partes (Tipo, URL, Protocolo) ¿Cuantas peticiones NO tienen como protocolo "HTTP/0.2"?**

Respuesta

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
